<div id="homepage" class="d-grid">
  <div class="banner">
    <%= video_tag "UrgBackOFFICIAL", autoplay: true, loop: true, muted: true %>
    <div class="container text-center">
      <%= image_tag "uo_logo"%>
      <h1 class="text-center logo">Urgência Online</h1>
      <p class="text-center logo">Procure por um hospital específico</p>
      <%= form_with url: root_path, method: :get, class: "d-flex search-bar" do %>

        <%= text_field_tag :query,
              params[:query],
              class: "form-control",
              placeholder: "Buscar hospitais"
          %>
        <%= submit_tag "Buscar", name: "", class: "btn btn-primary d-hidden" %>
      <% end %>
    </div>
  </div>

  <div class="hospitals-index container">
    <h2 class="text-center">Selecione um hospital</h2>
    <div class="cards-wrapper">
      <% @hospitals.each do |hospital| %>
        <div class="hospital-card d-flex justify-content-between">
          <%= image_tag "MapsHospital2.png" %>
          <div class="right-content">
            <div class="hospital-info">
              <h3><%= link_to hospital.name, hospital_path(hospital) %></h3>
              <p><%= hospital.address %></p>

            </div>
              <% position = Appointment.where(hospital_id: hospital).count %>
              <% position_minutes = position * 20
                if position_minutes >= 60
                  hours = position_minutes / 60
                  remaining_minutes = position_minutes % 60
                  if hours == 1 %>
                    <p class='time-position'>Tempo estimado: <%= "#{hours} hora e #{remaining_minutes} minutos" %></p>
                  <% else %>
                    <p class='time-position'>Tempo estimado: <%= "#{hours} horas e #{remaining_minutes} minutos" %></p>
                  <% end
                else %>
                  <p class='time-position'>Tempo estimado: <%= "#{position_minutes} minutos" %></p>
                <% end %>

            <%= link_to "Entrar na fila", new_hospital_appointment_path(hospital), class: "btn btn-primary w-100" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
